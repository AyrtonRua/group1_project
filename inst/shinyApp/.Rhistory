# #
# #
axis.text.x= element_text( size=12),
axis.text.y= element_text( size=12) ) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),scales::pretty_breaks(5))
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
#
#
scale_y_continuous(labels = scales::percent_format(accuracy = 1),scales::pretty_breaks(5))
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge")
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
#
#
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29])
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29])
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
#
#
scale_y_continuous(labels = scales::percent_format(accuracy = 1),scales::pretty_breaks(5))
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29])
library(viridis)
library(viridis)
library(tidyverse)
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T)
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T, end = 0.8)
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T, end = 0.2)
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T, end = 0.9)
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T)
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_brewer()
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_brewer(palette = "pal6")
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T)
+ scale_y_continuous(labels = scales::percent_format(accuracy = 1),scales::pretty_breaks(5))
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),scales::pretty_breaks(5))
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(scales::pretty_breaks(5))
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1) )
library(scales)
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = pretty_breaks(5) )
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = pretty_breaks(10) )
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = pretty_breaks(8) )
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = pretty_breaks(8) )  +
coord_flip()
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = pretty_breaks(5) )  +
coord_flip()
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = pretty_breaks(5) )  +
coord_flip() +theme_minimal()
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = pretty_breaks(5) )  +
coord_flip() +theme_excel_new()
library(ggthemes)
library("tidyverse")
library("scales")
library("ggthemes")
library("viridis")
data_factor %>%  ggplot(aes(data_factor[, 2], fill = data_factor[, 1])) +
# # #
geom_bar(aes(y  = (..count..)/tapply(..count..,..PANEL..,sum)[..PANEL..],
#
#
fill = fct_infreq(data_factor[, 2])), position = "dodge") +
guides(fill = FALSE)  +
# # #
# # #
labs(title = paste(colnames(data_factor)[2]    , sep = ""),
x = "",
y = "")  +  facet_grid(~data_factor[, 29]) +
scale_fill_viridis(discrete = T) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1), breaks = pretty_breaks(5) )  +
coord_flip() +theme_excel_new()
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo=FALSE,
cache = FALSE, error = FALSE, self.contained=FALSE)
#loading saved final data
data_credit <- readRDS("../data/data_credit.rds")
str(data_credit)
library("gdata")
#removing all the non used datasets for efficiency
gdata::keep(data_credit, sure = TRUE)
#loading saved final data
data_credit <- readRDS("../data/data_credit_models_withobs.rds")
#loading saved final data
data_credit <- readRDS("../Report Final/data_credit_models_withobs.rds")
#checking data is correct
str(data_credit)
#loading saved final data
data_credit <- readRDS("../data/data_credit.rds")
str(data_credit)
#loading saved final data
data_credit <- readRDS("../data/data_credit_correct1.rds")
#checking data is correct
str(data_credit)
#loading saved final data
data_credit <- readRDS("../Data_Analytics_Project/data/data_credit_correct1.rds")
#loading saved final data
data_credit <- readRDS("../data/data_credit_correct1.rds")
data_credit[537,23]
#checking data is correct
str(data_credit)
#loading saved final data
data_credit <- readRDS("../data/data_credit_correct1.rds")
#checking data is correct
str(data_credit)
#removing all the non used datasets for efficiency
gdata::keep(data_credit, sure = TRUE)
#checking data is correct
str(data_credit)
data_credit
#checking data is correct
str(data_credit)
#loading saved final data
data_credit <- readRDS("../data/data_credit.rds")
#checking data is correct
str(data_credit)
data_credit[537,23]
#loading saved final data
data_credit <- readRDS("../data/data_credit.rds")
#checking data is correct
str(data_credit)
data_credit[537,23] <- "75"
data_credit[537,23] <- "75"
library("gdata")
#removing all the non used datasets for efficiency
gdata::keep(data_credit, sure = TRUE)
#loading saved final data
data_credit <- readRDS("../data/data_credit.rds")
#checking data is correct
str(data_credit)
data_credit[537,23]
#loading saved final data
data_credit <- readRDS("../data/data_credit.rds")
#correctin outlier age value of 125 => to true value of 75 based on PROFESSOR
#data_credit %>% filter(AGE==125)
#
data_credit[537,23] <- "75"
data_credit$AGE <- as.numeric(data_credit$AGE)
saveRDS(data_credit, file = "../data/data_credit_agecorrect.rds")
#loading saved final data
data_credit <- readRDS("../data/data_credit_agecorrect.rds")
#checking data is correct
str(data_credit)
data_credit[537,23]
#loading saved final data
data_credit <- readRDS("../data/data_credit.rds")
#checking data is correct
str(data_credit)
#loading saved final data
data_credit <- readRDS("../data/data_credit_correct1.rds")
#checking data is correct
str(data_credit)
data_credit[537,23]
data_numerical <- data_credit[,c(3, 11, 23,32)]
#loading saved final data
data_credit <- readRDS("../data/data_credit_correct1.rds")
plottype3 <- sapply(data_credit,class,simplify = TRUE) %>% as.data.frame()
data_numerical <- data_credit[,c(3, 11, 23,32)]
library(GGally)
library(ggthemes)
ggpairs(
data_numerical,
mapping = ggplot2::aes(color = RESPONSE),
upper = list(continuous = wrap("cor", alpha = 1,size=3), combo = "facethist"),
lower = list(continuous = wrap("smooth_loess", alpha = 0.3), combo = wrap("box", alpha = 1)),
# #
# #
columnLabels=c("Duration","Amount","Age","Response"),
axisLabels="none")   + theme_minimal()
shiny::runApp('~/Desktop/courses 2nd year/Autumn semester 2018/Programming Tools in Data Science/FINAL HOMEWORKS/Project/group1_project/touristR/inst/shinyApp')
#add namespace and remove packages to be done!!!!!
library("shiny")
library("magrittr")
library("leaflet")
library("tidyverse")
library("shinyWidgets")
library("DT")
library("touristR")
twitterfetch <-  touristR::getTopNAttractions( "paris", 1)
View(twitterfetch)
runApp()
runApp()
shiny::runApp()
runApp()
twitterfetch <-  touristR::getTopNAttractions(  "paris", 2)
View(twitterfetch)
View(twitterfetch)
#correcting the levels and format of the  fetched data
twitterfetch <-  data.frame(lapply(twitterfetch, function(x) unlist(x)))
twitterfetch$lat <-     as.numeric(levels(twitterfetch$lat))[twitterfetch$lat]
twitterfetch$lng <-     as.numeric(levels(twitterfetch$lng))[twitterfetch$lng]
twitterfetch$name <-     as.character(levels(twitterfetch$name))[twitterfetch$name]
twitterfetch$hashtag <-     as.character(levels(twitterfetch$hashtag))[twitterfetch$hashtag]
twitterfetch$hashtag
twitterfetch
str(twitterfetch)
twitterfetch <- twitterfetch %>% mutate("sentimentcolor" =
ifelse(sentimentAbsolute == 1, "green", ifelse(sentiment == 0, "orange","red"))
)
twitterfetch <- twitterfetch %>% mutate("sentimentcolor" =
ifelse(sentimentAbsolute == 1, "green", ifelse(sentimentAbsolute == 0, "orange","red"))
)
twitterfetch <- twitterfetch %>% mutate("sentimentcolor" =
ifelse(sentimentRelative == 1, "green", ifelse(sentimentRelative == 0, "orange","red")))
runApp()
Authenticate?
?Authenticate
Authenticate?
shiny::runApp()
